Venda.namespace('Widget.MinicartDetail');Venda.Widget.MinicartDetail=function(){};jQuery(function(){if(jQuery('.minicart').length>0){Venda.Widget.MinicartDetail.Create()}});Venda.Widget.MinicartDetail.Create=function(){Venda.Widget.MinicartDetail.settings={enable:true,topPad:140,leftPad:174,fade:true,scroll:true,openDuration:0.4,visibleTime:8,highlight:true,highlightColor:"#95E85F",highlightOpacity:0.4,highlightDuration:4,header:true,closeButton:true,draggable:false,showOnHover:false,closeOnOusideClick:true};if(Venda.Widget.MinicartDetail.settings.enable===true){if(Venda.Widget.MinicartDetail.settings.showOnHover===false){jQuery(".showminicart").click(function(e){Venda.Widget.MinicartDetail.InterceptCartLink(e)})}else{jQuery(".showminicart").click(function(e){e.preventDefault()});jQuery(".showminicart").mouseover(function(e){Venda.Widget.MinicartDetail.InterceptCartLink(e)})};Venda.Widget.MinicartDetail.mouseOver=false;Venda.Widget.MinicartDetail.PopupMinicart();Venda.Widget.MinicartDetail.CollectCheckbox();Venda.Widget.MinicartDetail.GatherAdds();if(jQuery(".demo").length>0){Venda.Widget.MinicartDetail.settings.topPad+=jQuery(".demo").outerHeight(true)};if(jQuery(".admin").length>0){Venda.Widget.MinicartDetail.settings.topPad+=jQuery(".admin").outerHeight(true)}}};Venda.Widget.MinicartDetail.CollectCheckbox=function(){jQuery('label.addToCheckBoxLabel').css('display','block');jQuery('input.addToCheckBox').each(function(){jQuery(this).removeAttr("checked")});jQuery('#checkAllProducts').removeAttr("checked");switch(jQuery('.attributesForm').attr('id')){case'productdetailMulti':jQuery('.buyControlsMulti').prepend('<label>'+jQuery('#attributes-addAllProduct').text()+' <input type="checkbox" id="checkAllProducts" /></label>');jQuery('#checkAllProducts').click(function(){if(jQuery(this).attr('checked')=='checked'){jQuery('input.addToCheckBox').attr('checked','true');jQuery('input.addToCheckBox').each(function(){Venda.Widget.MinicartDetail.addCheckbox[jQuery(this).attr('id')]=true;jQuery('#itemlist_'+jQuery(this).attr('id')).removeAttr("disabled");jQuery('#qtylist_'+jQuery(this).attr('id')).removeAttr("disabled")})}else{jQuery('input.addToCheckBox').removeAttr('checked');jQuery('input.addToCheckBox').each(function(){Venda.Widget.MinicartDetail.addCheckbox[jQuery(this).attr('id')]=false;jQuery('#itemlist_'+jQuery(this).attr('id')).attr('disabled','true');jQuery('#qtylist_'+jQuery(this).attr('id')).attr('disabled','true')})}});Venda.Widget.MinicartDetail.addCheckbox={};jQuery('input.addToCheckBox').each(function(){Venda.Widget.MinicartDetail.addCheckbox[jQuery(this).attr('id')]=false;jQuery('#itemlist_'+jQuery(this).attr('id')).attr('disabled','true');jQuery('#qtylist_'+jQuery(this).attr('id')).attr('disabled','true');jQuery(this).click(function(){if(jQuery(this).attr("checked")=='checked'){Venda.Widget.MinicartDetail.addCheckbox[jQuery(this).attr('id')]=true;jQuery('#itemlist_'+jQuery(this).attr('id')).removeAttr("disabled");jQuery('#qtylist_'+jQuery(this).attr('id')).removeAttr("disabled")}else{Venda.Widget.MinicartDetail.addCheckbox[jQuery(this).attr('id')]=false;jQuery('#itemlist_'+jQuery(this).attr('id')).attr('disabled','true');jQuery('#qtylist_'+jQuery(this).attr('id')).attr('disabled','true')}})});break;case'productdetailSet':case'productset':jQuery('.buyControlsMulti').prepend('<label>'+jQuery('#attributes-addAllProduct').text()+' <input type="checkbox" id="checkAllProducts" /></label>');jQuery('#checkAllProducts').click(function(){if(jQuery(this).attr('checked')=='checked'){jQuery('input.addToCheckBox').attr('checked','true');jQuery('input.addToCheckBox').each(function(){Venda.Widget.MinicartDetail.addCheckbox[jQuery(this).attr('id')]=true;jQuery('#itemlist_'+jQuery(this).attr('id')).removeAttr("disabled");jQuery('#qtylist_'+jQuery(this).attr('id')).removeAttr("disabled")})}else{jQuery('input.addToCheckBox').removeAttr('checked');jQuery('input.addToCheckBox').each(function(){Venda.Widget.MinicartDetail.addCheckbox[jQuery(this).attr('id')]=false;jQuery('#itemlist_'+jQuery(this).attr('id')).attr('disabled','true');jQuery('#qtylist_'+jQuery(this).attr('id')).attr('disabled','true')})}});Venda.Widget.MinicartDetail.addCheckbox={};jQuery('input.addToCheckBox').each(function(){var uID=jQuery(this).closest('.oneProduct').attr('id');uID=uID.substr(11);Venda.Widget.MinicartDetail.addCheckbox[uID]=false;jQuery('#itemlist_'+jQuery(this).attr('id')).attr('disabled','true');jQuery('#qtylist_'+jQuery(this).attr('id')).attr('disabled','true');jQuery(this).click(function(){if(jQuery(this).attr("checked")=='checked'){Venda.Widget.MinicartDetail.addCheckbox[uID]=true;jQuery('#itemlist_'+jQuery(this).attr('id')).removeAttr("disabled");jQuery('#qtylist_'+jQuery(this).attr('id')).removeAttr("disabled")}else{Venda.Widget.MinicartDetail.addCheckbox[uID]=false;jQuery('#itemlist_'+jQuery(this).attr('id')).attr('disabled','true');jQuery('#qtylist_'+jQuery(this).attr('id')).attr('disabled','true')}})});break};jQuery('input.addToCheckBox').on('click',function(){var isTrue=false;var isFalse=false;for(var key in Venda.Widget.MinicartDetail.addCheckbox){if(Venda.Widget.MinicartDetail.addCheckbox[key]==true){isTrue=true}if(Venda.Widget.MinicartDetail.addCheckbox[key]==false){isFalse=true;isTrue=false}};if(isTrue==true&&isFalse==false){jQuery('#checkAllProducts').attr('checked','true')}if(isTrue==false&&isFalse==true){jQuery('#checkAllProducts').removeAttr("checked")}})};Venda.Widget.MinicartDetail.Validate=function(uID){if(Venda.Attributes.productArr.length>0){switch(jQuery('.attributesForm').attr('id')){case'productdetail':case'quickBuyFast':case'quickBuyDetails':case'productdetailSet':case'productset':case'quickShop':for(var i=0;i<Venda.Attributes.productArr.length;i++){if(uID==Venda.Attributes.productArr[i].attSet.id){if(Venda.Attributes.IsAllSelected(Venda.Attributes.productArr[i].attSet.att1.selected,Venda.Attributes.productArr[i].attSet.att2.selected,Venda.Attributes.productArr[i].attSet.att3.selected,Venda.Attributes.productArr[i].attSet.att4.selected,uID)){if(jQuery("#oneProduct_"+uID+" .qty").val()>0){switch(Venda.Attributes.Get('stockstatus')){case"Out of stock":alert(jQuery('#attributes-stockOut').text());return false;break;case"Not Available":alert(jQuery('#attributes-stockNA').text());return false;break;default:return true}}else{alert(jQuery('#attributes-quantity').text());jQuery("#oneProduct_"+uID+" .qty").focus().select();return false}}else{if(jQuery('.stockFeedbackBox').length>0){jQuery('.stockFeedbackBox').effect("pulsate",{times:2},700)}else{alert(jQuery('#attributes-chooseVariant').text())}return false}}}break;case'productdetailMulti':for(var i=0;i<Venda.Attributes.productArr.length;i++){if(uID==Venda.Attributes.productArr[i].attSet.id){for(var key in Venda.Widget.MinicartDetail.addCheckbox){if(Venda.Widget.MinicartDetail.addCheckbox[key]==true){if(jQuery("#oneProduct_"+uID+" #qtylist_"+key).val()>0){return true}else{alert(jQuery('#attributes-quantity').text());jQuery("#oneProduct_"+uID+" #qtylist_"+key).focus().select();return false}}}return true}}break}}else{if(jQuery("#oneProduct_"+uID+" .qty").val()>0){return true}else{alert(jQuery('#attributes-quantity').text());jQuery("#oneProduct_"+uID+" .qty").focus().select();return false}}};Venda.Widget.MinicartDetail.GatherAdds=function(){jQuery(".addproduct, .buynow").click(function(e){var formID=jQuery(this).parents('form:first').attr('id');var addOrBuy=(jQuery(this).hasClass('addproduct'))?'add':'buy';if(Venda.Attributes.attsArray.length>0){switch(jQuery('.attributesForm').attr('id')){case'productdetail':case'quickBuyFast':case'quickBuyDetails':var uID=jQuery(this).closest('.oneProduct').attr('id');uID=uID.substr(11);var isValid=Venda.Widget.MinicartDetail.Validate(uID);if(isValid){if(addOrBuy=='add'){Venda.Widget.MinicartDetail.AddProduct(formID);e.preventDefault()}}else{e.preventDefault();return false}break;case'productdetailMulti':var uID=jQuery(this).closest('.oneProduct').attr('id');uID=uID.substr(11);var anySelected=0;for(var key in Venda.Widget.MinicartDetail.addCheckbox){if(Venda.Widget.MinicartDetail.addCheckbox[key]==true){anySelected++}}if(anySelected>0){var isValid=Venda.Widget.MinicartDetail.Validate(uID);if(isValid){if(addOrBuy=='add'){Venda.Widget.MinicartDetail.AddProduct(formID);e.preventDefault()}}else{e.preventDefault();return false}}else{alert(jQuery('#attributes-noneChecked').text());e.preventDefault();return false}break;case'productdetailSet':case'productset':var anyInvalid=0;var anySelected=0;for(var key in Venda.Widget.MinicartDetail.addCheckbox){if(Venda.Widget.MinicartDetail.addCheckbox[key]==true){anySelected++}}if(anySelected>0){jQuery('.oneProduct').each(function(){var uID=jQuery(this).attr('id');uID=uID.substr(11);if(Venda.Widget.MinicartDetail.addCheckbox[uID]==true){var isValid=Venda.Widget.MinicartDetail.Validate(uID);if(!isValid){anyInvalid+=1}}});if(anyInvalid==0){if(addOrBuy=='add'){Venda.Widget.MinicartDetail.AddProduct(formID);e.preventDefault()}}else{e.preventDefault();return void(0)}}else{alert(jQuery('#attributes-noneChecked').text());e.preventDefault();return false}break}}else{if(jQuery('.attributesForm').attr('id')!='quickShop'){if(addOrBuy=='add'){var uID=jQuery(this).closest('.oneProduct').attr('id');uID=uID.substr(11);var isValid=Venda.Widget.MinicartDetail.Validate(uID);if(isValid){Venda.Widget.MinicartDetail.AddProduct(formID);e.preventDefault()}else{e.preventDefault();return false}}}};if(jQuery('.attributesForm').attr('id')=='quickShop'){var isValid=true;Venda.Widget.MinicartDetail.trackingProdAddEnable=false;jQuery('.oneProduct').each(function(){var uID=jQuery(this).attr('id');uID=uID.substr(11);if((jQuery(this).find('#attributeInputs').length>0)&&(jQuery(this).find('.attroutofstock').is(':visible'))){alert(jQuery('#attributes-stockOut').text());isValid=false;return false}if(jQuery(this).find(".prodoutofstock").length<1){isValid=Venda.Widget.MinicartDetail.Validate(uID)}if(!isValid){e.preventDefault();return false}});if(isValid){Venda.Widget.MinicartDetail.AddProduct(formID);e.preventDefault()}else{e.preventDefault();return false}}})};Venda.Widget.MinicartDetail.PopupMinicart=function(){Venda.Widget.MinicartDetail.popupMinicartObj=new jQuery("#minicartDetailWrapper");var dialogOpts={autoOpen:false,resizable:false,modal:false,closeOnEscape:false,draggable:Venda.Widget.MinicartDetail.settings.draggable,dialogClass:"minicartDetailDialog"};Venda.Widget.MinicartDetail.popupMinicartObj.dialog(dialogOpts);if(Venda.Widget.MinicartDetail.settings.header===true){Venda.Widget.MinicartDetail.popupMinicartObj.dialog("option","title",document.getElementById("tag-headertext").innerHTML);if(Venda.Widget.MinicartDetail.settings.closeButton===false){jQuery(".minicartDetailDialog .ui-dialog-titlebar-close").css({"display":"none"})}}else{jQuery(".minicartDetailDialog .ui-dialog-titlebar").css({"display":"none"})};if(Venda.Widget.MinicartDetail.settings.visibleTime!==0){jQuery(".minicartDetailDialog").mouseenter(function(){Venda.Widget.MinicartDetail.mouseOver=true;clearTimeout(Venda.Widget.MinicartDetail.popupTimerId)});jQuery(".minicartDetailDialog").mouseleave(function(){Venda.Widget.MinicartDetail.mouseOver=false;Venda.Widget.MinicartDetail.PopupTimer()})};if(Venda.Widget.MinicartDetail.settings.closeOnOusideClick===true){jQuery(".showminicart").click(function(){return false});jQuery(".minicartDetailDialog").click(function(e){e.stopPropagation()});jQuery(document).click(function(){if(Venda.Widget.MinicartDetail.IsAnimInAction("return")===false&&Venda.Widget.MinicartDetail.popupMinicartObj.dialog("isOpen")===true){Venda.Widget.MinicartDetail.CloseAnim()}})}};Venda.Widget.MinicartDetail.AddProduct=function(formID){var defaultLayout=document.getElementById(formID).layout.value;var defaultEx=document.getElementById(formID).ex.value;document.getElementById(formID).layout.value='minicart';document.getElementById(formID).ex.value="co_disp-shopc";if(typeof document.getElementById(formID).curlayout!='undefined'){document.getElementById(formID).curlayout.value='minicart'};if(Venda.Widget.MinicartDetail.popupMinicartObj.dialog("isOpen")===false){Venda.Widget.MinicartDetail.OpenAnim("addToBasket")}else{jQuery("#minicartDetailWrapper").html("<div class='loaderBar'></div>")}jQuery.ajax({type:"POST",url:document.getElementById("tag-codehttp").innerHTML,data:jQuery("#"+formID).serializeToLatin1(),global:false,success:function(html){jQuery("#addedmsg").css({"display":"none"});jQuery("#minicartDetailWrapper").html(html);Venda.Widget.MinicartDetail.UpdateMinicart();Venda.Widget.MinicartDetail.WrapBasket();var headeHeight=0;if(Venda.Widget.MinicartDetail.settings.header===true){headeHeight=jQuery('.minicartDetailDialog .ui-dialog-titlebar').outerHeight()}var initHeight=jQuery('.minicartDetail').outerHeight()+headeHeight;Venda.Widget.MinicartDetail.initHeight=initHeight;var attributes={'height':initHeight+'px'};jQuery('.minicartDetailDialog').animate(attributes,200,function(){Venda.Widget.MinicartDetail.HighlightAdded();if(Venda.Widget.MinicartDetail.settings.visibleTime!==0){if(Venda.Widget.MinicartDetail.mouseOver==false){Venda.Widget.MinicartDetail.PopupTimer()}}});document.getElementById(formID).layout.value=defaultLayout;document.getElementById(formID).ex.value=defaultEx;if(jQuery(".currencyConverter").length){if(jQuery('#tag-currencycode')&&jQuery(this).pennies('get')!==null){if(jQuery(this).pennies('get')!=jQuery('#tag-currencycode').html()){jQuery('#updateTotal').pennies('convert',{to:jQuery(this).pennies('get'),from:jQuery('#tag-currencycode').html()}).delay(1000)}}}}});jQuery('body').trigger('minicart-items-added')};Venda.Widget.MinicartDetail.UpdateMinicart=function(){jQuery("#updateItems").text(document.getElementById('updatemdItems').innerHTML);jQuery("#updateTotal").text(document.getElementById('updatemdTotal').innerHTML).data('price',document.getElementById('updatemdTotal').innerHTML);if(parseInt(document.getElementById('updatemdItems').innerHTML)==1){jQuery(".updatebdItemsText").text(document.getElementById('tag-itemBD').innerHTML)}else{jQuery(".updatebdItemsText").text(document.getElementById('tag-itemsBD').innerHTML)}};Venda.Widget.MinicartDetail.HighlightAdded=function(){if(Venda.Widget.MinicartDetail.settings.highlight===true){var attributes;var attOrNo=(Venda.Attributes.attsArray.length>0)?Venda.Attributes.dataObj.atrsku:document.getElementById('tag-addedmsgref').innerHTML;if(Venda.Widget.MinicartDetail.settings.highlightColor!==""){jQuery("#minicartDetailHighlight_"+attOrNo).css({"backgroundColor":Venda.Widget.MinicartDetail.settings.highlightColor,"opacity":"0"});attributes={"opacity":Venda.Widget.MinicartDetail.settings.highlightOpacity};jQuery("#minicartDetailHighlight_"+attOrNo).animate(attributes,(1000),function(){var letsDelay=setTimeout(function(){attributes={"opacity":"0"};jQuery("#minicartDetailHighlight_"+attOrNo).animate(attributes,(1000),function(){document.getElementById('tag-addedmsgref').innerHTML=""})},(Venda.Widget.MinicartDetail.settings.highlightDuration-2)*1000)})}}};Venda.Widget.MinicartDetail.InterceptCartLink=function(e){if(Venda.Widget.MinicartDetail.IsAnimInAction("return")===false){if(Venda.Widget.MinicartDetail.popupMinicartObj.dialog("isOpen")==false){Venda.Widget.MinicartDetail.OpenAnim()}else{Venda.Widget.MinicartDetail.CloseAnim()}}e.preventDefault()};Venda.Widget.MinicartDetail.WrapBasket=function(){if(jQuery("#minicart_products li").length>3){var maxHeight=0;var totalItems=jQuery("#minicart_products li").size();var perpage=3;var pages=Math.ceil(totalItems/perpage);var step=1;jQuery('#minicart_products li:lt(4)').each(function(){maxHeight+=jQuery(this).outerHeight()});jQuery("#basketHolder").css({'overflow':'hidden','height':maxHeight+'px'});jQuery("#basketWrapper").prepend("<button id='scrollUp' class='basketScroll'>&nbsp;</button>");jQuery("#basketWrapper").append("<button id='scrollDown' class='basketScroll'>&#9660;</button>");var top=0;jQuery("#scrollUp").on("click",function(){if(step>1){step-=1;top+=maxHeight;jQuery("#minicart_products").animate({'margin-top':top+'px'},200,function(){jQuery("#scrollDown").html("&#9660;")})}if(step==1){jQuery("#scrollDown").html("&#9660;");jQuery(this).html("&nbsp;")}});jQuery("#scrollDown").on("click",function(){if(step<pages){step+=1;top-=maxHeight;jQuery("#minicart_products").animate({'margin-top':top+'px'},200,function(){jQuery("#scrollUp").html("&#9650;")})}if(step==pages){jQuery("#scrollUp").html("&#9650;");jQuery(this).html("&nbsp;")}})}};Venda.Widget.MinicartDetail.OpenAnim=function(act){Venda.Widget.MinicartDetail.IsAnimInAction(true);var topPos=Venda.Widget.MinicartDetail.settings.topPad;var leftPos=jQuery(window).width()/2+Venda.Widget.MinicartDetail.settings.leftPad;var topPosAndMargin=topPos-10;var initHeight=149;Venda.Widget.MinicartDetail.popupMinicartObj.dialog("option","position",[leftPos,topPos]);if(jQuery('#minicartDetail').length>0){if(act=="addToBasket"){jQuery("#minicartDetailWrapper").html("<div class='loaderBar'></div>")}else{initHeight=Venda.Widget.MinicartDetail.initHeight}}else{jQuery("#minicartDetailWrapper").html("<div class='loaderBar'></div>")}var attributes={'height':'0px','opacity':'0'};jQuery('.minicartDetailDialog').css(attributes);if(Venda.Widget.MinicartDetail.settings.fade===true&&Venda.Widget.MinicartDetail.settings.scroll===true){jQuery('.minicartDetailDialog').css({'height':'0px'});attributes={'height':initHeight+'px','opacity':'1'}};if(Venda.Widget.MinicartDetail.settings.fade===true&&Venda.Widget.MinicartDetail.settings.scroll===false){jQuery('.minicartDetailDialog').css({'height':'auto'});attributes={'opacity':'1'}};if(Venda.Widget.MinicartDetail.settings.fade===false&&Venda.Widget.MinicartDetail.settings.scroll===true){jQuery('.minicartDetailDialog').css({'height':'0px','opacity':'1'});attributes={'height':initHeight+'px'}};jQuery('.minicartDetailDialog').animate(attributes,(Venda.Widget.MinicartDetail.settings.openDuration*1000),function(){Venda.Widget.MinicartDetail.IsAnimInAction(false);if(act!="addToBasket"){if(!jQuery('#minicartDetail').length){jQuery('#minicartDetailWrapper').load('/page/home&layout=minicart',function(){Venda.Widget.MinicartDetail.WrapBasket();if(jQuery(".minicart_empty").length){jQuery("#minicart_totals, #minicart_links").css({"display":"none"})};var headeHeight=0;if(Venda.Widget.MinicartDetail.settings.header===true){headeHeight=jQuery('.minicartDetailDialog .ui-dialog-titlebar').outerHeight()}var initHeight=jQuery('.minicartDetail').outerHeight()+headeHeight;Venda.Widget.MinicartDetail.initHeight=initHeight;attributes={'height':initHeight+'px'};jQuery('.minicartDetailDialog').animate(attributes,200,function(){if(Venda.Widget.MinicartDetail.settings.visibleTime!==0){if(Venda.Widget.MinicartDetail.mouseOver==false){Venda.Widget.MinicartDetail.PopupTimer()}}})})}else{if(Venda.Widget.MinicartDetail.mouseOver==false){Venda.Widget.MinicartDetail.PopupTimer()}}}});function SetPos(){if(jQuery(window).scrollTop()>topPosAndMargin){topPos=10;jQuery('.minicartDetailDialog').css({"position":"fixed","top":topPos+"px"})}else{topPos=Venda.Widget.MinicartDetail.settings.topPad-jQuery(window).scrollTop();jQuery('.minicartDetailDialog').css({"position":"absolute","top":topPos+"px"})}Venda.Widget.MinicartDetail.popupMinicartObj.dialog("option","position",[leftPos,topPos])}SetPos();window.onscroll=function(){SetPos()};window.onresize=function(){SetPos()};if(jQuery(".currencyConverter").length){if(jQuery('#tag-currencycode')&&(typeof jQuery().pennies!=='undefined')){jQuery('#minicartDetailWrapper .price').pennies('convert',{to:jQuery(this).pennies('get'),from:jQuery('#tag-currencycode').html()})}}Venda.Widget.MinicartDetail.popupMinicartObj.dialog("open")};Venda.Widget.MinicartDetail.CloseAnim=function(){if(Venda.Widget.MinicartDetail.settings.fade===false&&Venda.Widget.MinicartDetail.settings.scroll===false){Venda.Widget.MinicartDetail.popupMinicartObj.dialog("close")}else{Venda.Widget.MinicartDetail.IsAnimInAction(true);if(Venda.Widget.MinicartDetail.settings.visibleTime!=0){clearTimeout(Venda.Widget.MinicartDetail.popupTimerId)};var attributes={'height':'auto','opacity':'1'};jQuery('.minicartDetailDialog').css(attributes);if(Venda.Widget.MinicartDetail.settings.fade===false&&Venda.Widget.MinicartDetail.settings.scroll===false){Venda.Widget.MinicartDetail.popupMinicartObj.dialog("close")};if(Venda.Widget.MinicartDetail.settings.fade===true&&Venda.Widget.MinicartDetail.settings.scroll===true){attributes={'height':'0px','opacity':'0'}};if(Venda.Widget.MinicartDetail.settings.fade===true&&Venda.Widget.MinicartDetail.settings.scroll===false){attributes={'opacity':'0px'}};if(Venda.Widget.MinicartDetail.settings.fade===false&&Venda.Widget.MinicartDetail.settings.scroll===true){jQuery('.minicartDetailDialog').css({'opacity':'1'});attributes={'height':'0px'}};jQuery('.minicartDetailDialog').animate(attributes,(Venda.Widget.MinicartDetail.settings.openDuration*1000),function(){Venda.Widget.MinicartDetail.popupMinicartObj.dialog("close");Venda.Widget.MinicartDetail.IsAnimInAction(false)})}};Venda.Widget.MinicartDetail.isAnimInActionVal=false;Venda.Widget.MinicartDetail.IsAnimInAction=function(obj){if(obj===true||obj===false){Venda.Widget.MinicartDetail.isAnimInActionVal=obj}if(obj==="return"){return Venda.Widget.MinicartDetail.isAnimInActionVal}}Venda.Widget.MinicartDetail.popupTimerId=0;Venda.Widget.MinicartDetail.PopupTimer=function(){Venda.Widget.MinicartDetail.popupTimerId=setTimeout('Venda.Widget.MinicartDetail.CloseAnim()',(Venda.Widget.MinicartDetail.settings.visibleTime*1000))};Venda.Widget.MinicartDetail.ParamAddProduct=function(invtRef,qty,att1,att2){var requestURL=document.getElementById("tag-codehttp").innerHTML+"?invt="+invtRef+"&buy="+invtRef+"&qty="+qty+"&att1="+att1+"&att2="+att2+"&ex=co_disp-shopc&mode=add&log=22&layout=minicartDetail&next=&curpage=&bsref="+document.getElementById("tag-bsref").innerHTML;jQuery.ajax({type:"POST",url:requestURL,global:false,success:function(html){jQuery("#minicartDetailWrapper").html(html);Venda.Widget.MinicartDetail.UpdateMinicart();if(Venda.Widget.MinicartDetail.popupMinicartObj.dialog("isOpen")==false){Venda.Widget.MinicartDetail.OpenAnim()};Venda.Widget.MinicartDetail.HighlightAdded();if(Venda.Widget.MinicartDetail.settings.visibleTime!=0){clearTimeout(Venda.Widget.MinicartDetail.popupTimerId)}}})};jQuery("#qtybox #qty").keypress(function(e){if(e.keyCode==13){jQuery('.addproduct').trigger('click');e.preventDefault()}});jQuery("#addproductbox .buynow").click(function(e){document.form.ex.value='co_wizr-shopcart'});jQuery("#addproductbox .preorder").click(function(e){document.form.ex.value='co_disp-shopc';e.preventDefault()});