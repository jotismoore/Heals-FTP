<style>fieldset div {padding-bottom: 5px;}.error{background:none;color:#C1392D;}#checkout .error {padding:0;}</style>
<input type="hidden" name="page" value="myaccount"> 
<!-- Hit Ext fields need be passed again, if errors are not null -->
<input type="hidden" name="htxt" value="<venda_htxt mode=make,addr=change>">
<!-- pass communication values otherwise these will be reset when the address details are updated -->
<input type="hidden" name="blkpost" value="<venda_blkpost>">
<input type="hidden" name="blkemail" value="<venda_blkemail>">
<input type="hidden" name="blksms" value="<venda_blksms>">
<input type="hidden" name="blktrdcomm" value="<venda_blktrdcomm>">
<input type="hidden" name="usmailform" value="<venda_usmailform>">
<venda_usemail field=hidden>
<venda_uspswd field=hidden>
<venda_uspswd2 field=hidden>
<h1 class="hide">Edit Billing Address</h1>
<venda_block label=2,errors=notnull><h2 class="error"><venda_errors></h2></venda_block label=2>
<venda_tpcomment><!-- Start: Edit Contact Details --></venda_tpcomment>
<fieldset class="f-myformdetail">
<legend class="myformdetail"><venda_text id=site.my_account.edit_user_details.edit_contact_details.legend.your_contact_details></legend>
<div><label for="title"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.title><span class="re-waiHide"> (required)</span> <span class="required">*</span></label>
<select name="title" id="title">
	<option value="Mr"<venda_block label=101,title=Mr> selected</venda_block label=101>>Mr</option>
	<option value="Mrs"<venda_block label=111,title=Mrs> selected</venda_block label=111>>Mrs</option>
	<option value="Miss"<venda_block label=121,title=Miss> selected</venda_block label=121>>Miss</option>
	<option value="Ms"<venda_block label=131,title=Ms> selected</venda_block label=131>>Ms</option>
	<option value=" "<venda_block label=141,title=> selected</venda_block label=141>>Other</option>
</select>
</div>
<div><label for="fname"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.first_name><span class="re-waiHide"> (required)</span> <span class="required">*</span></label> <venda_fname field=text,size=25,maxlength=30,required=yes></div>
<venda_block label=123,mode=value,<venda_setting type=ebiz,name=showmname>=1>
<div><label for="mname"><venda_text id=site.contact_address.label.middle_name></label> <venda_mname field=text,size=25,maxlength=30></div>
</venda_block label=123>
<div><label for="lname"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.last_name><span class="re-waiHide"> (required)</span> <span class="required">*</span></label> <venda_lname field=text,size=25,maxlength=30,required=yes></div>
<venda_block label=124,mode=value,<venda_setting type=ebiz,name=showcompany>=1>
<div><label for="company"><venda_text id=site.contact_address.label.company></label> <venda_company field=text,size=25,maxlength=60></div>  </venda_block label=124>
<venda_block label=88,mode=value,<venda_setting type=ebiz,name=nohousenum>!=1><div><label for="num"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.house_name_flat_number><span class="re-waiHide"> (required)</span> <span class="required">*</span></label> <venda_num field=text,size=25,maxlength=20,required=yes></div></venda_block label=88>
<div><label for="addr1"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.address><span class="re-waiHide"> (required)</span> <span class="required">*</span></label> <venda_addr1 field=text,size=25,maxlength=50,required=yes></div>
<div><label for="addr2"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.address2></label> <venda_addr2 field=text,size=25,maxlength=50></div>
<div><label for="city"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.city><span class="re-waiHide"> (required)</span> <span class="required">*</span></label> <venda_city field=text,size=25,maxlength=30,required=yes></div>

<div id="stateDiv"><label for="state" id="stateLabel"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.county></label> <span id="statelistbox"><select id="statelist" name="statelist" class=admn_fieldsLarge onchange="setState(document.getElementById('statetext'),this.value);"></select></span><span id="statetextbox"><input type="text" id="statetext" name="state" value="<venda_state>" class=admn_fieldsLarge size=15 maxlength=20></span></div>

<div id="zipcDiv"><label for="zipc" id="zipcLabel"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.postcode></label> <venda_zipc field=text,size=25,maxlength=20,required=yes></div>

<div id="countryDiv"><label for="cntry" id="countryLabel"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.country><span class="re-waiHide"> (required)</span> <span class="required">*</span></label> <venda_cntry  field=combo,class=admn_fieldsLarge,required=yes,onchange=1></div>

	<script type="text/javascript">
		setDropDownDefault(document.getElementById("cntrylist"), '<venda_cntry>');
		hasState(document.getElementById('statelistbox'),document.getElementById('statetextbox'),document.getElementById('statelist'),'<venda_cntry>');
		setDropDownDefault(document.getElementById("statelist"), '<venda_state>');
	</script>

<div><div><label for="phone" class="dontFloat"><venda_text id=site.my_account.edit_user_details.edit_contact_details.label.phone_number><span class="re-waiHide"> (required)</span> <span class="required">*</span></label> <venda_block label=101,mode=value,<venda_setting type=ebiz,name=hidearea>!=1><label for="area" class="dontFloat invisible"></label></venda_block label=101></div> <venda_block label=100,mode=value,<venda_setting type=ebiz,name=hidearea>!=1><venda_area field=text,size=4,maxlength=6,required=yes> </venda_block label=100><venda_phone field=text,size=18,maxlength=20,required=yes></div>
<venda_block label=123,mode=value,<venda_setting type=ebiz,name=showfax>=1>
<div><div><label for="fax" class="dontFloat"><venda_text id=site.contact_address.label.fax_number></label> <venda_block label=101,mode=value,<venda_setting type=ebiz,name=hidearea>!=1><label for="farea" class="dontFloat invisible"><venda_text id=site.contact_address.label.fax_area_code></label></venda_block label=101></div> <venda_block label=100,mode=value,<venda_setting type=ebiz,name=hidearea>!=1><venda_farea field=text,size=4,maxlength=6> </venda_block label=100><venda_fax field=text,size=18,maxlength=20></div>
</venda_block label=123>
</fieldset>
<venda_tpxt mode=set,name=myacctrack,value=editdetails>
<venda_tpcomment><!-- End: Edit Contact Details --></venda_tpcomment>
<SCRIPT type="text/javascript">
<!-- Hide
// isRequiredField - this param is set to 'true' when country field is 'US', for validating State and Zipcode
var isRequiredField = false;
function CheckFields(form1) {

        if (form1.fname.value == "") {
                alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.first_name>");
                return;
        }

        if (form1.lname.value == "") {
                alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.last_name>");
                return;
        }
<venda_block label=88,mode=value,<venda_setting type=ebiz,name=nohousenum>!=1>
        if (form1.num.value == "") {
                alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.num>");
                return;
        }
</venda_block label=88>
        if (form1.addr1.value == "") {
                alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.addr1>");
                return;
        }

        if (form1.city.value == "") {
                alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.city>");
                return;
        }
        if(isRequiredField){
        	if (form1.statelist.value == "") { 
                alert('<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.state>');
                return ; 
            }

        }
        	if (form1.zipc.value == "") { 
                alert('<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.zipc>');
                return ; 
            }
		if (form1.cntry.value == "") {
                alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.cntry>");
                return;
        }
        <venda_block label=100,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>
        if (form1.area.value == "") {
                alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.area>");
                return;
        }
        </venda_block label=100>
        if (form1.phone.value == "") {
                alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.phone>");
                return;
        }
		
		// strip hyphens
		<venda_block label=101,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>form1.area.value=form1.area.value.replace(/-/g,"");</venda_block label=101>
		form1.phone.value=form1.phone.value.replace(/-/g,"");
		// strip whitespace
		<venda_block label=102,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>form1.area.value=form1.area.value.replace(/ /g,"");</venda_block label=102>
		form1.phone.value=form1.phone.value.replace(/ /g,"");
		// phone number validation
		// not alpha characters
		var filterNumber = /[^\d]/;
        <venda_block label=103,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>
		if (filterNumber.test(form1.area.value)==true) {
			alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.area_digits>");
			form1.area.focus();
			return false;
		}
        </venda_block label=103>
		if (filterNumber.test(form1.phone.value)==true) {
			alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.phone_digits>");
			form1.phone.focus();
			return false;
		}

		// fax number validation if present
		<venda_block label=155,mode=value,<venda_setting type=ebiz,name=showfax>=1>
		// strip hyphens
		<venda_block label=104,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>form1.farea.value=form1.farea.value.replace(/-/g,""); </venda_block label=104>
		form1.fax.value=form1.fax.value.replace(/-/g,"");
		// strip whitespace
		<venda_block label=105,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>form1.farea.value=form1.farea.value.replace(/ /g,""); </venda_block label=105>
		form1.fax.value=form1.fax.value.replace(/ /g,"");
        <venda_block label=205,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>
		if (form1.farea.value != "") {
			if (filterNumber.test(form1.farea.value)==true) {
				alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.farea_digits>");
				form1.farea.focus();
				return false;
			}
        </venda_block label=205>
			if (filterNumber.test(form1.fax.value)==true) {
				alert("<venda_text id=site.my_account.edit_user_details.edit_contact_details.js_validation.fax_digits>");
				form1.fax.focus();
				return false;
			}
        <venda_block label=206,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>}</venda_block label=206>
		</venda_block label=155>
		
	form1.submit();
}
//End Javascript-->
</SCRIPT>

<div id="buttons">
<input type="image" onClick="CheckFields(document.form); return false;" src="<venda_entmediaadd>/ebiz/<venda_bsref>/resources/images/my-account/my-account-submit.gif" alt="<venda_text id=site.button.submit>">
</div>

<script type="text/javascript">
function swapLabel(){
        var stateLabel = document.getElementById("stateLabel");
        var zipcLabel = document.getElementById("zipcLabel");
        var cntryLabel = document.getElementById("countryLabel");
        var country = document.getElementById("cntrylist");

	if(country == undefined) { return; } //if country is undefined do nothing

                if(country.value == "United States"){
                        stateLabel.innerHTML = '<venda_text id=site.contact_address.label.us_state>:<span class="re-waiHide"> (required)</span> <span class="required">*</span>';
                        zipcLabel.innerHTML = '<venda_text id=site.contact_address.zipc.us_zipcode>:<span class="re-waiHide"> (required)</span> <span class="required">*</span>';
                        isRequiredField = true;
                }
                else if(country.value == "United Kingdom"){
                        stateLabel.innerHTML = '<venda_text id=site.contact_address.label.uk_county>:';
                        zipcLabel.innerHTML = '<venda_text id=site.contact_address.zipc.non_us_postcode>:<span class="re-waiHide"> (required)</span> <span class="required">*</span>';
                        isRequiredField = false;
                }
                else {
                        stateLabel.innerHTML = '<venda_text id=site.contact_address.label.non_us_uk_region>:';
                        zipcLabel.innerHTML = '<venda_text id=site.contact_address.zipc.non_us_postcode>:';
                        isRequiredField = false;
                }
}
                window.onload = swapLabel;
                addEvent(document.form.cntry, 'change', swapLabel, true);
</script>
